<!-- <ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-item lines="none">
      <ion-icon (click)="goBack()" class="back" name="arrow-back"></ion-icon>
      <ion-title>Add Purchase</ion-title>
    </ion-item>
  </ion-toolbar>
</ion-header> -->

<ion-content [fullscreen]="true">
  <div class="Customer">
    <div>
      <ion-card-content>
        <div class="dekstop-menu">
          <ion-card-header>
            <ion-row lines="none">
              <ion-icon (click)="goBack()" class="back" name="arrow-back"></ion-icon>
              <ion-title style="text-align: center;">Purchase Retrun</ion-title>
              <div class="custom-primary">
                <ion-button size="small" [routerLink]="['/view-purchasereturn']" id="open-loading5">View Purchase
                  Return</ion-button>
                <ion-loading class="custom-loading" trigger="open-loading5" message="Purchase Showing ..."
                  [duration]="1000"></ion-loading>
                <img id="menu" style="margin-left: 10px;" width="20px" height="20px" src="../../assets/more.png"
                  alt="more">
              </div>
            </ion-row>
          </ion-card-header>
        </div>
        <ion-grid>
          <form [formGroup]="myform" (ngSubmit)="onSubmit(myform,purchaseData)">

            <ion-row>
              <ion-col size-lg="1.5" size-md="2" size-sm="6" size="6">
                <ion-select class="always-flip" toggleIcon="caret-down-sharp" color="dark" interface="popover"
                  label="Bill Formate" label-placement="floating" fill="outline" [(ngModel)]="billformate"
                  formControlName="billformate" name="billformate">
                  <!-- <ion-select-option value="0" >Bill Formate</ion-select-option> Default option -->
                  <ion-select-option value="1">1</ion-select-option>
                  <ion-select-option value="2">2</ion-select-option>
                </ion-select>
              </ion-col>
              <ion-col size-lg="1.5" size-md="2" size-sm="6" size="6">
                <ion-row>
                  <ion-input #firstInvalidInput [(ngModel)]="billNumber" formControlName="billNumber" name="billno"
                    type="number" label=" Billing No.  :" label-placement="floating" fill="outline"
                    (keydown)="onKeyDown($event)"></ion-input>
                </ion-row>
              </ion-col>

              <ion-col size-lg="1.5" size-md="2" size-sm="6" size="6">
                <ion-row>
                  <ion-input [(ngModel)]="frombill" formControlName="frombill" name="frombill" type="text"
                    label="From Billing No :" label-placement="floating" fill="outline"></ion-input>
                </ion-row>
              </ion-col>

              <ion-col size-lg="1.5" size-md="2" size-sm="6" size="6">
                <ion-row>
                  <ion-input [(ngModel)]="billDate" formControlName="billDate" name="billdate" type="date"
                    label=" Billing Date   :" label-placement="floating" fill="outline"></ion-input>
                </ion-row>
              </ion-col>
              <ion-col size-lg="1.5" size-md="2" size-sm="6" size="6">
                <ion-row>
                  <ion-input color="dark" [(ngModel)]="vendcode" (change)="getSuppliers($event)"
                    formControlName="vendcode" name="vendcode" type="text" label="Code :" label-placement="floating"
                    fill="outline"></ion-input>
                </ion-row>
              </ion-col>


              <ion-col size-lg="2.6" size-md="3" size-sm="6" size="6">
                <ion-select class="always-flip" toggleIcon="caret-down-sharp" color="dark" interface="popover"
                  (change)="getSuppliers($event)" label="--- Supplier Name --- " label-placement="floating"
                  fill="outline" [(ngModel)]="vendcode" formControlName="supplier" name="spler">
                  <!-- <ion-select-option value="0"> --- Supplier Name --- </ion-select-option>Default option -->
                  <ion-select-option *ngFor="let suppliername of supplier$ | async" [value]="suppliername.id">
                    {{ suppliername.name }}
                  </ion-select-option>
                </ion-select>
              </ion-col>

              <ion-col class="custom-primary" size-lg="0.4" size-md="2" size-sm="2" size="2">
                <ion-button (click)="presentPopovers($event)"><ion-icon
                    name="person-add-outline"></ion-icon></ion-button>
              </ion-col>

              <ion-col size-lg="1.5" size-md="2" size-sm="6" size="6">
                <ion-row>
                  <ion-input [(ngModel)]="gstin" formControlName="gstin" name="gstincode" type="text" label=" GSTIN  :"
                    label-placement="floating" fill="outline"></ion-input>
                </ion-row>
              </ion-col>

              <ion-col size-lg="1.5" size-md="2" size-sm="6" size="6">
                <ion-row>
                  <ion-input color="dark" [(ngModel)]="refrence" formControlName="refrence" name="refrence" type="text"
                    label="Refrence No.:" label-placement="floating" fill="outline"></ion-input>
                </ion-row>
              </ion-col>

              <ion-col size-lg="2" size-md="2" size-sm="6" size="6">
                <ion-row>
                  <ion-input color="dark" [(ngModel)]="refdate" formControlName="refdate" name="refdate" type="date"
                    label="Ref. Date :" label-placement="floating" fill="outline"></ion-input>
                </ion-row>
              </ion-col>
              <ion-col size-lg="2" size-md="2" size-sm="6" size="6">
                <ion-row>
                  <ion-input [(ngModel)]="orderNumber" formControlName="orderNumber" name="orderno" type="text"
                    label="Order Number  :" label-placement="floating" fill="outline"></ion-input>
                </ion-row>
              </ion-col>
              <ion-col size-lg="2" size-md="2" size-sm="6" size="6">
                <ion-row>
                  <ion-input [(ngModel)]="orderDate" formControlName="orderDate" name="orDate" type="date"
                    label="Order Date :" label-placement="floating" fill="outline"></ion-input>
                </ion-row>
              </ion-col>

              <ion-col class="ponumber" size-lg="2" size-md="2" size-sm="6" size="6">
                <ion-row>
                  <ion-input [(ngModel)]="ponumber" formControlName="ponumber" name="ponumber" type="text"
                    label="PO Number  :" label-placement="floating" fill="outline"></ion-input>
                </ion-row>
              </ion-col>

              <ion-col size-lg="2.6" size-md="2" size-sm="6" size="6">
                <ion-select class="always-flip" toggleIcon="caret-down-sharp" color="dark" interface="popover"
                  label="Payment Mode" label-placement="floating" fill="outline" [(ngModel)]="payment"
                  formControlName="payment" name="pyt">
                  <!-- <option value="0">
                   Payment Mode</option> -->
                  <ion-select-option value="0">Cash</ion-select-option>
                  <ion-select-option value="1">Credit</ion-select-option>
                </ion-select>
              </ion-col>
              <ion-col size-lg="1.9" size-md="2" size-sm="6" size="6">
                <ion-select class="always-flip" toggleIcon="caret-down-sharp" color="dark" interface="popover"
                  label="--- Executive Name ---" label-placement="floating" fill="outline" [(ngModel)]=" executive"
                  formControlName="executive" name="executive">
                  <!-- <ion-select-option value="">  --- Executive Name --- </ion-select-option>Default option -->
                  <ion-select-option *ngFor="let executive of executive$ | async" [value]="executive.executiveid">
                    {{ executive.executivename }}
                  </ion-select-option>
                </ion-select>
              </ion-col>

            </ion-row>


            <ion-row style="margin-top: 7px;">
              <div class="scroll-container">

                <table style="width:100%;overflow-x: auto;">
                  <tr>
                    <th>Sr.No.</th>
                    <!-- <th>BarCode</th> -->
                    <th>Item Code</th>
                    <th>Item Name</th>
                    <th>Description</th>
                    <th>Quantity</th>
                    <th>Unit</th>
                    <th>MRP</th>
                    <th>Basic Rate</th>
                    <th>Net Rate</th>
                    <th>Gross Amount</th>
                    <th>GST</th>
                    <!-- <th>CGST</th>
                    <th>SGST</th>
                    <th>IGST</th> -->
                    <th>Discount By</th>
                    <th>Discount Amount</th>
                    <th>Tax Amount</th>
                    <th>Net Amount</th>
                    <th>Action</th>
                  </tr>
                  <tr *ngFor="let purchase of purchaseData; let i = index">
                    <td>{{i+1}}</td>
                    <!-- <td>
                      <input [(ngModel)]="purchase.barcode" (ngModelChange)="getItems(purchase)"
                        [ngModelOptions]="{standalone: true}" class="table_input" type="text">
                    </td> -->
                    <td>
                      <input [(ngModel)]="purchase.itemcode" (ngModelChange)="getItems(purchase)"
                        [ngModelOptions]="{standalone: true}" class="table_input" type="text">
                    </td>
                    <td>
                      <select class="select-option" [(ngModel)]="purchase.selectedItemId"
                        [ngModelOptions]="{standalone: true}" (ngModelChange)="getItems(purchase)">
                        <option value="0">Item Name</option><!-- Default option -->
                        <option *ngFor="let itemname of itemnames$ | async" [value]="itemname.tid">
                          {{ itemname.itemDesc }}
                        </option>
                      </select>

                      <ion-input style="display: none;" [(ngModel)]="purchase.itemid"
                        [ngModelOptions]="{standalone: true}" type="hidden"></ion-input>
                      <ion-input style="display: none;" [(ngModel)]="companyid" [ngModelOptions]="{standalone: true}"
                        type="hidden"></ion-input>
                      <ion-input style="display: none;" [(ngModel)]="userid" [ngModelOptions]="{standalone: true}"
                        type="hidden"></ion-input>
                    </td>
                    <td>
                      <input [(ngModel)]="purchase.description" [ngModelOptions]="{standalone: true}"
                        class="table_input  description" type="text">
                    </td>
                    <td>
                      <input *ngIf="purchase.itemcode !== 0" [(ngModel)]="purchase.quantity"
                        [ngModelOptions]="{standalone: true}" class="table_input" type="number"
                        (keydown)="onKeyDown($event)" (keydown.enter)="openQuantityPopover(purchase)">

                    </td>
                    <td>
                      <input [(ngModel)]="purchase.unitname" [ngModelOptions]="{standalone: true}" class="table_input"
                        type="text">
                      <input [(ngModel)]="purchase.hunitname" [ngModelOptions]="{standalone: true}" type="hidden">
                      <!-- <select class="select-option" [(ngModel)]="purchase.unitname" (ngModelChange)="getItems(purchase)"
                        [ngModelOptions]="{standalone: true}">
                        <option value="0">Unit Name</option>
                        <option *ngFor="let unitname of unitname$ | async" [value]="unitname.unitid">
                          {{ unitname.unitname }}
                        </option>
                      </select> -->
                    </td>
                    <td>
                      <input [(ngModel)]="purchase.mrp" [ngModelOptions]="{standalone: true}" class="table_input"
                        type="text" (keydown)="onKeyDown($event)">
                    </td>
                    <td>
                      <input [(ngModel)]="purchase.basicrate" [ngModelOptions]="{standalone: true}" class="table_input"
                        type="number" (keydown)="onKeyDown($event)">

                    </td>
                    <td>
                      <input [readonly]="true" [value]="getnetrate(purchase)" class="table_input" type="text"
                        (keydown)="onKeyDown($event)">
                    </td>
                    <td>
                      <input [readonly]="true" [value]="getgrossrate(purchase)" class="table_input" type="number"
                        (keydown)="onKeyDown($event)">
                    </td>
                    <td>
                      <input [(ngModel)]="purchase.taxrate" [ngModelOptions]="{standalone: true}" class="table_input"
                        type="number" (keydown)="onKeyDown($event)">
                      <!-- <select class="select-option" id="taxrate" #taxrate (change)="onSelectChange(taxrate,purchase)"
                        [(ngModel)]="purchase.taxrate" [ngModelOptions]="{standalone: true}">
                        <option value="0" (ngModelChange)="getItems(purchase)"> GST</option>
                        <option *ngFor="let gsttype of taxrate$ | async" [value]="gsttype.gstid">
                          {{ gsttype.gstname }}
                        </option>
                      </select> -->
                    </td>
                    <input type="hidden" [(ngModel)]="purchase.taxrate1" [ngModelOptions]="{standalone: true}" />

                    <!-- <td>
                      <input [readonly]="true" [value]="getcgst(purchase)" class="table_input" type="text">
                    </td>
                    <td>
                      <input [readonly]="true" [value]="getsgst(purchase)" class="table_input" type="text">
                    </td>
                    <td>
                      <input [readonly]="true" [value]="getigst(purchase)" class="table_input" type="text">
                    </td> -->
                    <td style="width: 90px;">
                      <select class="select-option" formControlName="discountType">
                        <option value="amount">Amount</option>
                        <option value="percentage">Percentage</option>
                      </select>
                    </td>
                    <td *ngIf="myform.get('discountType')?.value === 'percentage'">
                      <input [(ngModel)]="purchase.discount" (ionBlur)="getdiscountp(purchase)"
                        [ngModelOptions]="{standalone: true}" class="table_input" type="text"
                        (keydown)="onKeyDown($event)">
                    </td>
                    <td *ngIf="myform.get('discountType')?.value === 'amount'">
                      <input [(ngModel)]="purchase.discountamt" [value]="getdiscountamt(purchase)"
                        (keyup)="getdiscountamt(purchase)" [ngModelOptions]="{standalone: true}" class="table_input"
                        type="text" (keydown)="onKeyDown($event)">
                    </td>
                    <td>
                      <input [readonly]="true" [value]="getTotaltax(purchase)" class="table_input" type="number"
                        (keydown)="onKeyDown($event)">
                    </td>
                    <td>
                      <input [readonly]="true" [value]="getTotalamt([purchase])" class="table_input" type="text">

                    </td>

                    <td>
                      <ion-icon icon-only clear color="primary" name="add" (click)="addPurchase()"></ion-icon>
                      <ion-icon *ngIf="i>0" icon-only clear color="danger" name="trash"
                        (click)="removePurchase(i,purchase)"></ion-icon>
                    </td>
                  </tr>
                </table>

              </div>
              <div style="overflow-x: auto; border: 1px solid grey; width: 100%;">

                <ion-row>
                  <ion-col class="row_data" size="12" size-lg="2" size-md="2" size-sm="6">
                    <label class="label_table" for="">Total Item :</label>
                    <input name="totalitemno" [(ngModel)]="purchaseData.length" formControlName="totalitemno"
                      class="input_table" type="text">
                  </ion-col>

                  <ion-col class="row_data" size="12" size-lg="2" size-md="2" size-sm="6">
                    <label class="label_table" for="">Quantity : </label>

                    <input name="totalquantity" [(ngModel)]="totalquantity" [value]="getTotalQuantity()"
                      formControlName="totalquantity" class="input_table" type="number" (keydown)="onKeyDown($event)">

                  </ion-col>

                  <ion-col class="row_data" size="12" size-lg="2" size-md="2" size-sm="6">
                    <label class="label_table" for="">Gross Amount :</label>
                    <input name="totalgrossamt" [(ngModel)]="totalgrossamt" [value]="getTotalGrossAmount()"
                      formControlName="totalgrossamt" class="input_table" type="number" (keydown)="onKeyDown($event)">

                  </ion-col>

                  <ion-col class="row_data" size="12" size-lg="2" size-md="2" size-sm="6">
                    <label class="label_table" for="">Discount Amount : </label>
                    <input name="totaldiscountamt" [(ngModel)]="totaldiscountamt" [value]="getTotalDiscountAmount()"
                      formControlName="totaldiscountamt" class="input_table" type="number"
                      (keydown)="onKeyDown($event)">

                  </ion-col>

                  <ion-col class="row_data" size="12" size-lg="2" size-md="2" size-sm="6">
                    <label class="label_table" for="">Tax Amount :</label>
                    <input name="totaltaxamount" [(ngModel)]="totaltaxamount" [value]="getTotalTaxAmount()"
                      formControlName="totaltaxamount" class="input_table" type="number" (keydown)="onKeyDown($event)">

                  </ion-col>

                  <ion-col class="row_data" size="12" size-lg="2" size-md="2" size-sm="6">
                    <label class="label_table" for="">Taxable Amount :</label>
                    <input name="totalnetamount" [(ngModel)]="totalnetamount" formControlName="totalnetamount"
                      [value]="getTaxableAmount()" class="input_table" type="number" (keydown)="onKeyDown($event)">

                  </ion-col>
                </ion-row>
              </div>

            </ion-row>


            <ion-row>
              <ion-col class="row1" size-lg="3" size-md="3" size-sm="3" size="12">
                <div class="row3">
                  <ion-label class="delivery-label" style="font-size: small;">Scheduled Delivery</ion-label>
                  <div class="outstanding">
                    <ion-row>
                      <table class="delivery-table" style="width: 100%; overflow: hidden;">
                        <tr>
                          <th style="width: 100px !important;">Delivery Date</th>
                          <td>
                            <ion-input type="date" [(ngModel)]="deliverydate" formControlName="deliverydate"
                              name="deliverydate" placeholder="Enter Delivery Date"></ion-input>
                          </td>
                        </tr>
                        <tr>
                          <th style="width: 100px !important;">Delivery Place</th>
                          <td>
                            <ion-input type="text" [(ngModel)]="deliveryplace" formControlName="deliveryplace"
                              name="deliveryplace" placeholder="Enter Delivery Place"></ion-input>
                          </td>
                        </tr>
                      </table>
                    </ion-row>
                  </div>
                </div>
              </ion-col>

              <ion-col class="row1" size-lg="4" size-md="6" size-sm="6" size="12">
                <ion-label class="delivery-label" style="font-size: smaller;">OutStanding</ion-label>
                <div class="outstanding">
                  <ion-row>
                    <table style="width: 100%; overflow: hidden; max-height: 60px;">
                      <tr>
                        <th style="width: 100px !important;">Opening Balance</th>
                        <td>
                          <ion-input type="number" [(ngModel)]="openingbalance" formControlName="openingbalance"
                            name="openingbalance" placeholder="Enter Opening Balance"
                            (keydown)="onKeyDown($event)"></ion-input>
                        </td>
                        <th style="width: 100px !important;">Debit</th>
                        <td>
                          <ion-input type="number" [(ngModel)]="debit" formControlName="debit" name="debit"
                            placeholder="Enter  Dedit Amount" (keydown)="onKeyDown($event)"></ion-input>
                        </td>
                      </tr>
                      <tr>
                        <th style="width: 100px !important;">Closing Balance</th>
                        <td>
                          <ion-input type="number" [(ngModel)]="closingbalance" formControlName="closingbalance"
                            name="closingbalance" placeholder="Enter Closing Balance"
                            (keydown)="onKeyDown($event)"></ion-input>
                        </td>
                        <th style="width: 100px !important;">Credit</th>
                        <td>
                          <ion-input type="number" [(ngModel)]="credit" formControlName="credit" name="credit"
                            placeholder="Enter Credit Amount" (keydown)="onKeyDown($event)"></ion-input>
                        </td>
                      </tr>
                    </table>
                  </ion-row>
                </div>
              </ion-col>
              <ion-col class="row1" size-lg="2" size-md="3" size-sm="3" size="12">
                <!-- <ion-label class="delivery-label" style="font-size: smaller;">Total</ion-label>
              <div class="outstanding">
                <ion-row>
                  <table style="width: 100%; overflow: hidden; max-height: 60px;">
                    <tr>
                      <th style="text-align: left;">Total Item :</th>
                      <td> <input  [(ngModel)]="totalitemno"  formControlName="totalitemno" name="totalitemno"  class="table_input" type="text">
                      </td>
                    </tr>
                    <tr>
                      <th style="text-align: left;">Total Quantity :</th>
                      <td> <input  [(ngModel)]="totalquantity"  formControlName="totalquantity"  name="totalquantity"  class="table_input" type="text">
                      </td>
                    </tr>
                  </table>
                </ion-row>
              </div> -->
              </ion-col>

              <ion-col class="row" size-lg="3" size-md="12" size-sm="12" size="12">
                <div class="output" style="border: none;margin-left: 30px;">
                  <table>

                    <tr>
                      <th colspan="2">Discount Amount :</th>
                      <td colspan="2"> <input [(ngModel)]="totaldiscountamt" [value]="getTotalDiscountAmount()"
                          id="totaldiscountamt" formControlName="totaldiscountamt" name="totaldiscountamt"
                          class="row_input" type="text">
                      </td>
                    </tr>

                    <tr>
                      <th colspan="2">Tax Amount : </th>
                      <td colspan="2"> <input [(ngModel)]="totaltaxamount" [value]="getTotalTaxAmount()"
                          id="totaltaxamount" formControlName="totaltaxamount" name="totaltaxamount" class="row_input"
                          type="text">
                      </td>
                    </tr>

                    <tr>
                      <th colspan="2">Round Off : </th>
                      <td colspan="2"> <input [(ngModel)]="roundoff" formControlName="roundoff" name="roundoff"
                          [value]="getRoundoff()" id="roundoff" class="row_input" type="number"
                          (keydown)="onKeyDown($event)">
                      </td>
                    </tr>
                    <tr>
                      <th colspan="2">Pre-Tax : </th>
                      <td colspan="2"> <input [(ngModel)]=" pretax" formControlName="pretax" name="pretax" id="pretax"
                          class="row_input" type="number" (keydown)="onKeyDown($event)">
                      </td>
                    </tr>
                    <tr>
                      <th colspan="2">Post-Tax : </th>
                      <td colspan="2"> <input [(ngModel)]="posttax" formControlName="posttax" name="posttax"
                          id="posttax" class="row_input" type="number" (keydown)="onKeyDown($event)">
                      </td>
                    </tr>

                    <tr>
                      <th colspan="2">Grand Total : </th>
                      <td colspan="2"> <input [(ngModel)]="totalnetamount" formControlName="totalnetamount"
                          [value]="getGrandTotal()" id="totalnetamount" name="totalnetamount" class="row_input"
                          type="text">
                      </td>
                    </tr>
                  </table>
                </div>
              </ion-col>
            </ion-row>
            <ion-row class="custom-primary" style="justify-content: right;margin-top: 20px;">
              <ion-button id="open-loading" (click)="onNew()">New</ion-button>
              <ion-loading class="custom-loading" trigger="open-loading" message="Cleaning..."
                [duration]="1000"></ion-loading>
              <ion-button type="submit">Save</ion-button>
              <ion-button id="open-loading4" (click)="onButtonClick()">Close</ion-button>
              <ion-loading class="custom-loading" trigger="open-loading4" message="Customer Closing..."
                [duration]="1000"></ion-loading>
              <ion-button (click)="printThisPage()"><ion-icon name="print" slot="end" size="small"
                  color="secondry"></ion-icon>Print</ion-button>
              <ion-button (click)="printThisPage()"><ion-icon name="eye" slot="end" size="small"
                  color="secondry"></ion-icon>Preview</ion-button>
            </ion-row>
            <ion-popover class="quantity" #quantityPopover [isOpen]="isQuantityPopoverOpen">
              <ng-template>
                <ion-content>
                  <div class="popup" style="padding: 10px;">
                    <table style="width: 100%;">
                      <tr class="attributes" *ngFor="let purchase of purchaseData; let i = index">
                        <th>Sr. No.</th>
                        <ng-container *ngIf="purchase.attribute1">
                            <th><input type="text" formControlName="attribute1" [(ngModel)]="purchase.attribute1" class="pop_input" readonly></th>
                        </ng-container>
                        <ng-container *ngIf="purchase.attribute2">
                            <th><input type="text" formControlName="attribute2" [(ngModel)]="purchase.attribute2" class="pop_input" readonly></th>
                        </ng-container>
                        <ng-container *ngIf="purchase.attribute3">
                            <th><input type="text" formControlName="attribute3" [(ngModel)]="purchase.attribute3" class="pop_input" readonly></th>
                        </ng-container>
                        <ng-container *ngIf="purchase.attribute4">
                            <th><input type="text" formControlName="attribute4" [(ngModel)]="purchase.attribute4" class="pop_input" readonly></th>
                        </ng-container>
                        <ng-container *ngIf="purchase.attribute5">
                            <th><input type="text" formControlName="attribute5" [(ngModel)]="purchase.attribute5" class="pop_input" readonly></th>
                        </ng-container>
                        <ng-container *ngIf="purchase.attribute6">
                            <th><input type="text" formControlName="attribute6" [(ngModel)]="purchase.attribute6" class="pop_input" readonly></th>
                        </ng-container>
                        <ng-container *ngIf="purchase.attribute7">
                            <th><input type="text" formControlName="attribute7" [(ngModel)]="purchase.attribute7" class="pop_input" readonly></th>
                        </ng-container>
                        <ng-container *ngIf="purchase.attribute8">
                            <th><input type="text" formControlName="attribute8" [(ngModel)]="purchase.attribute8" class="pop_input" readonly></th>
                        </ng-container>
                    </tr>
                       <!-- <tr><td>{{tatts}}</td></tr> -->
                       <tr *ngFor="let row of purchaseData[0]?.quantityPopoverData; let i = index ">
                        <td>{{i+1}}</td>
                        <ng-container *ngIf="tatts>=0">
                          <td><input type="text" formControlName="attr1" [(ngModel)]="row.attr1" class="pop_input"></td>
                        </ng-container>
                        <ng-container *ngIf="tatts>=1">
                          <td><input type="text" formControlName="attr2" [(ngModel)]="row.attr2" class="pop_input"></td>
                        </ng-container>
                        <ng-container *ngIf="tatts>=2">
                          <td><input type="text" formControlName="attr3" [(ngModel)]="row.attr3" class="pop_input"></td>
                        </ng-container>
                        <ng-container *ngIf="tatts>=3">
                          <td><input type="text" formControlName="attr4" [(ngModel)]="row.attr4" class="pop_input"></td>
                        </ng-container>
                        <ng-container *ngIf="tatts>=4">
                          <td><input type="text" formControlName="attr5" [(ngModel)]="row.attr5" class="pop_input"></td>
                        </ng-container>
                        <ng-container *ngIf="tatts>=5">
                          <td><input type="text" formControlName="attr6" [(ngModel)]="row.attr6" class="pop_input"></td>
                        </ng-container>
                        <ng-container *ngIf="tatts>=6">
                          <td><input type="text" formControlName="attr7" [(ngModel)]="row.attr7" class="pop_input"></td>
                        </ng-container>
                        <ng-container *ngIf="tatts>=7">
                          <td><input type="text" formControlName="attr8" [(ngModel)]="row.attr8" class="pop_input"></td>
                        </ng-container>
                      </tr>
                    </table>
                    <ion-row class="custom-primary" style="justify-content: right; margin-top: 20px;">
                      <ion-button style="float: right; bottom: 0;" (click)="closeQuantityPopover()">Ok</ion-button>
                    </ion-row>
                  </div>
                </ion-content>
              </ng-template>
            </ion-popover>
          </form>
        </ion-grid>
      </ion-card-content>
    </div>
  </div>
</ion-content>

<ion-popover trigger="customer" #popover [isOpen]="isOpen" (didDismiss)="isOpen = false" side="bottom" alignment="end">
  <ng-template>
    <ion-content class="ion-padding Customer ">
      <form [formGroup]="vendorpop" (ngSubmit)="onVendorSubmit()">
        <ion-row style="justify-content: center;margin-bottom: 10px;">
          <ion-label class="executive">Add Vendor</ion-label>
        </ion-row>
        <ion-row>
          <ion-col size="6" size-lg="3" size-md="6" size-sm="6">
            <ion-row>
              <ion-input #firstInvalidInput [(ngModel)]="vendor_code" formControlName="vendor_code" type="text"
                label=" Vendor Code :" label-placement="floating" name="vcode" fill="outline" maxlength="5"></ion-input>

            </ion-row>
          </ion-col>
          <ion-col size="6" size-lg="5" size-md="6" size-sm="6">
            <ion-row>
              <ion-input [(ngModel)]="name" formControlName="name" type="text" label="Vendor Name :"
                label-placement="floating" name="customername" fill="outline"></ion-input>
            </ion-row>
          </ion-col>

          <ion-col size="6" size-lg="4" size-md="6" size-sm="6">
            <ion-row>
              <ion-input [(ngModel)]="gstin" formControlName="gstin" type="text" label=" GSTIN :"
                label-placement="floating" name="gstincode" fill="outline" maxlength="15"></ion-input>

            </ion-row>
          </ion-col>

          <ion-col size="6" size-lg="3" size-md="6" size-sm="6">
            <ion-row>
              <ion-input [(ngModel)]="mobile" formControlName="mobile" type="tel" label=" Mobile Number :"
                label-placement="floating" name="phonenumber" fill="outline" maxlength="10"></ion-input>
            </ion-row>
          </ion-col>

          <ion-col size="6" size-lg="3" size-md="6" size-sm="6">
            <select class="select" [(ngModel)]="country" formControlName="country" name="selectedCountry"
              label-placement="floating" fill="outline" (change)="onCountryChange()">
              <option value="0"> --- Country --- </option> <!-- Default option with value 0 -->
              <option *ngFor="let country of (countries$ | async)" [value]="country.countryid">
                {{ country.countryname }}
              </option>
            </select>
          </ion-col>

          <ion-col size="6" size-lg="3" size-md="6" size-sm="6">
            <select class="select" [(ngModel)]="state" formControlName="state" name="selectedState"
              label-placement="floating" (change)="onStateChange()">
              <option value="0"> --- State --- </option> <!-- Default option with value 0 -->
              <option *ngFor="let state of (states$ | async)" [value]="state.stateid">
                {{ state.statename }}
              </option>
            </select>

          </ion-col>
          <ion-col size="6" size-lg="3" size-md="6" size-sm="6">

            <select class="select" [(ngModel)]="district" formControlName="district" name="selectedDistrict"
              label-placement="floating" fill="outline">
              <option value="0"> --- District --- </option> <!-- Default option with value 0 -->
              <option *ngFor="let district of (districts$ | async)" [value]="district.districtid">
                {{ district.districtname }}
              </option>
            </select>
          </ion-col>

          <ion-col size="6" size-lg="3" size-md="6" size-sm="6">
            <ion-row>
              <ion-input [(ngModel)]="pincode" formControlName="pincode" type="text" label=" PinCode  :"
                label-placement="floating" name="pcode" fill="outline" inputmode="numeric" maxlength="6"></ion-input>
            </ion-row>
          </ion-col>

          <ion-col size="12" size-lg="9" size-md="6" size-sm="6">
            <ion-row>
              <ion-input [(ngModel)]="address" formControlName="address" type="text" label="Full Address :"
                label-placement="floating" name="fname" fill="outline"></ion-input>
            </ion-row>
          </ion-col>
        </ion-row>

        <ion-row style="float: right;margin-top: 10px;">
          <ion-button type="submit">Save</ion-button>
          <ion-button (click)="closePopover()">Close</ion-button>
        </ion-row>
      </form>
    </ion-content>
  </ng-template>
</ion-popover>

<ion-popover class="menu" trigger="menu" side="bottom" alignment="end">
  <ng-template>
    <ion-content class="ion-padding">
      <ion-icon name="document"></ion-icon>
      <ion-icon name="print-outline"></ion-icon>
      <ion-icon (click)="onNew()" name="person-add-outline"></ion-icon>
    </ion-content>
  </ng-template>
</ion-popover>